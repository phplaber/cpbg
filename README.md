# cpbg
Children's picture book generator - 儿童绘本生成器

## 简介

**cpbg** 就是用来生成儿童绘本的工具。你只需输入一段文本提示，可以是具体的任务（如：为3岁小男孩编写一本关于太空的绘本）或者是愿望（如：为3岁小男孩编写10本不同主题的绘本），接下来就可以离开位置去冲一杯美味的咖啡，剩下的工作交给程序去做。顺便说一句，背后真正干活的是 AI。

## 用法

运行工具，需安装 Python 3.6+。同时依赖 Azure OpenAI 服务，所以需先在 Azure 平台上部署模型。部署完成后，设置如下环境变量：

```bash
$ export azure_api_base="https://xxxx.openai.azure.com/" // 终结点
$ export azure_api_key="xxxx"                            // 密钥
$ export azure_api_version="2023-07-01-preview"          // API 版本
$ export deployment_name="xxxx"                          // 部署名
```

下载项目后，切换到项目目录。使用 pip3 安装依赖包：

```bash
$ pip3 install -r requirements.txt
```

简单查看下帮助文档

```bash
$ python3 main.py --help
Usage: main.py [OPTIONS] COMMAND [ARGS]...

Options:
  -T, --task TEXT    明确的任务，如：为3岁小男孩编写一本关于太空的绘本
  -D, --desire TEXT  一个愿望，由模型自动生成多个明确的任务，如：为3岁小男孩编写10本不同主题的绘本
  --help             Show this message and exit.
```

就是这样，赶快试试吧。

## 原理

首先，如果用户输入的是期望，则先通过该期望，结合系统提示，让 GPT 模型生成多个具体的任务。

其次，遍历这些任务。通过任务，结合系统提示，让 GPT 模型生成以任务为主题的内容，包括标题和段落。接着，依次以标题和段落为提示文本，让 DALL-E 模型生成相关图片。将图片下载到本地后，结合文字、图片和系统提示，让 GPT 模型将文字和图片结合，生成一个个 HTML 网页，即绘本页。

这样，就生成了一本绘声绘色的绘本了。

如果对系统提示有兴趣，可查看脚本 **prompts.py**。

## 示例

![小汽车的冒险之旅](/demo/01.png "小汽车的冒险之旅")
![小汽车开出了车库](/demo/02.png "小汽车开出了车库")
![它在马路上飞快的行驶](/demo/03.png "它在马路上飞快的行驶")
![红灯亮了，小汽车停下来等待](/demo/04.png "红灯亮了，小汽车停下来等待")
![绿灯亮了，小汽车继续前进](/demo/05.png "绿灯亮了，小汽车继续前进")
![小汽车在桥上行驶，风吹过车窗](/demo/06.png "小汽车在桥上行驶，风吹过车窗")
![小汽车经过了一片美丽的田野](/demo/07.png "小汽车经过了一片美丽的田野")
![它在山路上蜿蜒前行](/demo/08.png "它在山路上蜿蜒前行")
![小汽车来到了海边，可以看到大海的波浪](/demo/09.png "小汽车来到了海边，可以看到大海的波浪")
![它穿过了隧道，黑暗中闪烁着车灯](/demo/10.png "它穿过了隧道，黑暗中闪烁着车灯")
![小汽车在城市里穿梭，看到了高楼大厦](/demo/11.png "小汽车在城市里穿梭，看到了高楼大厦")
![它停在了一个公园，孩子们在草地上玩耍](/demo/12.png "它停在了一个公园，孩子们在草地上玩耍")
![小汽车继续旅程，来到了农场](/demo/13.png "小汽车继续旅程，来到了农场")
![它看到了农民在田地里劳作](/demo/14.png "它看到了农民在田地里劳作")
![小汽车回到了家，停在了车库](/demo/15.png "小汽车回到了家，停在了车库")
![它的冒险之旅结束了，小汽车安静地休息](/demo/16.png "它的冒险之旅结束了，小汽车安静地休息")
